<div class="container">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <div class="main-body">
        <div class="row gutters-sm justify-content-sm-center">
            <div class="col-sm-9">
                <div class="genericCard" *ngFor="let post of communityPostList;let i = index">
                    <mat-card>
                        <mat-card-header>
                            <div class="row col-sm-12">
                                <div class="col-sm-8" style="padding: 0px;margin: 0px;">
                                    <mat-card-title>
                                        {{post.title}}
                                    </mat-card-title>
                                    <mat-card-subtitle>
                                        <div>
                                            <a routerLink="" (click)="goToCommunity(post.comunity!)">
                                                {{communityName(post.comunity)}}
                                            </a>
                                        </div>
                                    </mat-card-subtitle>
                                </div>

                            </div>
                        </mat-card-header>
                        <mat-card-content>
                            <div class="row" style="margin-right: 0px;">
                                <div class="d-flex flex-column col-sm-1">
                                    <span class="material-icons vote up" style="font-size: 2rem;" (click)="upvote(post)"
                                        [ngClass]="{'active' : post.valoration=='UP' }">
                                        arrow_drop_up
                                    </span>
                                    <p style="text-align: center; margin: 0px; padding: 0px;">{{post.rated}}</p>
                                    <span class="material-icons vote down" style="font-size: 2rem;"
                                        (click)="downvote(post)" [ngClass]="{'active' : post.valoration=='DOWN' }">
                                        arrow_drop_down
                                    </span>
                                </div>
                                <div class="col-sm-11">
                                    <div>
                                        <ejs-richtexteditor value="{{ post.message }} " readonly="true"
                                            [toolbarSettings]="emptyTools">
                                        </ejs-richtexteditor>
                                    </div>
                                </div>
                            </div>
                            <div class="row justify-content-sm-center">
                                <div class="col-sm-10" style="margin-top: 10px;">
                                    <img style="width: 100%;" *ngIf="post.datosFoto" [src]="getImage(post.datosFoto)">
                                </div>
                            </div>
                        </mat-card-content>
                        <mat-card-footer>
                            <mat-card-subtitle>
                                <div class="row col-sm-4" style="margin-left: 20px;">
                                    <div>
                                        Autor: <a routerLink=""
                                            (click)="goToUserProfile(post.user!)">{{userName(post.user)}}</a>
                                    </div>
                                    <div>
                                        Publicado: {{getFormatedTime(post.createdAt)}}
                                    </div>
                                </div>
                            </mat-card-subtitle>
                            <div class="container">
                                <div class="container">
                                    <mat-form-field class="col-sm-12">
                                        <mat-label>Escriba un nuevo comentario*</mat-label>
                                        <input (keyup)="onKeyComment($event,post)" type="text"
                                            [(ngModel)]="post.nuevoComentario" name="comment-{{i}}" matInput />
                                    </mat-form-field>

                                    <div class="text-right">
                                        <div *ngIf="post.caracteresDeComentario && post.caracteresDeComentario>150">
                                            <p class="text-danger">Tu comentario solo puede tener 150 caracteres</p>
                                        </div>
                                        <button type="submit" class="btn btn-info" (click)=saveComment(post)>
                                            Comentar
                                        </button>

                                    </div>
                                </div>

                            </div>
                            <div class="container">
                                <p>Comentarios actuales</p>
                                <br>
                                <section *ngFor="let comment of post.commentPost" class="comments">
                                    <article class="comment">
                                        <a class="comment-img" href="#non">
                                            <img src="https://i.pinimg.com/564x/46/6c/02/466c0297a20203c8ba7ebd1f4cf0d21c.jpg"
                                                alt="" width="50" height="50">
                                        </a>
                                        <div class="comment-body">
                                            <div class="text">
                                                <p>{{comment.descripcion}}</p>
                                            </div>
                                            <p class="attribution">Por: <a routerLink=""
                                                    (click)="goToUserProfile(comment.user!)">{{comment.user?.nombreCompleto}}</a>
                                                Publicado el: {{getFormatedTime(comment.createdAt)}}</p>
                                        </div>
                                    </article>
                                </section>

                            </div>

                        </mat-card-footer>
                    </mat-card>
                </div>
            </div>
        </div>
        <div>
            <div class="d-flex justify-content-center">
                <div *ngIf="actualResponse" class="col-sm-4">
                    <button style="width: 100%;" type="button" class="btn btn-primary"
                        (click)="loadUserCommunitiesPost()">Cargar mas...</button>
                </div>
                <div *ngIf="!actualResponse" class="col-sm-4">
                    <p style="text-align: center;">Sin comentarios por mostrar</p>
                </div>
            </div>
        </div>
    </div>
</div>